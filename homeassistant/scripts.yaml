# media

set_denon_receiver_to_sonos_input:
  sequence:
    - service: media_player.turn_on
      entity_id: media_player.denon_avc_x6500h
    - service: media_player.turn_on
      entity_id: media_player.denon_avc_x6500h_2
    - service: media_player.select_source
      entity_id: media_player.denon_avc_x6500h
      data:
        source: Sonos
    - service: media_player.select_source
      entity_id: media_player.denon_avc_x6500h_2
      data:
        source: Sonos
    - service: media_player.media_play
      entity_id: media_player.denon_avc_x6500h
    - service: media_player.media_play
      entity_id: media_player.denon_avc_x6500h_2

# general

set_all_lights_to_default:
  sequence:
    - service: script.turn_on
      entity_id: script.set_bathroom_lights_to_default
    - service: script.turn_on
      entity_id: script.set_toilet_lights_to_default
    - service: script.turn_on
      entity_id: script.set_hallway_lights_to_default
    - service: script.turn_on
      entity_id: script.set_living_room_lights_to_default
    - service: script.turn_on
      entity_id: script.set_kitchen_lights_to_default
    - service: script.turn_on
      entity_id: script.set_office_lights_to_default
    - service: script.turn_on
      entity_id: script.set_bedroom_lights_to_default

turn_off_everything:
  sequence:
    - service: light.turn_off
      entity_id: group.all_lights
    - service: climate.turn_off
      entity_id: group.all_climate
    - service: script.turn_on
      entity_id: script.turn_off_media_everywhere

turn_off_media_and_lights_everywhere_except_bedroom:
  sequence:
    - service: light.turn_off
      entity_id: group.all_lights_except_bedroom
    - service: script.turn_on
      entity_id: script.turn_off_media_everywhere_except_bedroom

turn_off_media_everywhere:
  sequence:
    - service: script.turn_on
      entity_id: script.turn_off_music_everywhere
    - service: script.turn_on
      entity_id: script.turn_off_tvs_everywhere

turn_off_media_everywhere_except_bedroom:
  sequence:
    - service: media_player.media_pause
      entity_id: group.all_sonos_except_bedroom
    - service: light.turn_off
      entity_id: group.all_sonos_except_bedroom
    - service: script.turn_on
      entity_id: script.turn_off_denon_receiver
    - service: media_player.turn_off
      entity_id: media_player.living_room_tv_2
    - service: media_player.turn_off
      entity_id: media_player.living_room_tv

turn_off_tvs_everywhere:
  sequence:
    - service: media_player.turn_off
      entity_id: media_player.bedroom_tv_2
    - service: media_player.turn_off
      entity_id: media_player.living_room_tv_2
    - service: media_player.turn_off
      entity_id: media_player.bedroom_tv
    - service: media_player.turn_off
      entity_id: media_player.living_room_tv

turn_off_music_everywhere:
  sequence:
    - service: media_player.media_pause
      entity_id: group.all_sonos
    - service: light.turn_off
      entity_id: group.all_sonos
    - service: script.turn_on
      entity_id: script.turn_off_denon_receiver

turn_off_denon_receiver:
  sequence:
    - service: media_player.turn_off
      entity_id: media_player.denon_avc_x6500h
    - service: media_player.turn_off
      entity_id: media_player.denon_avc_x6500h_2

turn_on_necessary_things:
  sequence:
  - service: script.turn_on_heating_everywhere

turn_on_heating_everywhere:
  sequence:
    - service: climate.turn_on
      entity_id: climate.bathroom_floor
    - service: climate.turn_on
      entity_id: climate.kitchen_floor
    - service: climate.turn_on
      entity_id: climate.toilet_floor
    - service: climate.turn_on
      entity_id: climate.living_room
    - delay: '00:00:01'
    - service: climate.turn_on
      entity_id: climate.office
    - delay: '00:00:02'
    - service: climate.turn_on
      entity_id: climate.bathroom
    - delay: '00:00:03'
    - service: climate.turn_on
      entity_id: climate.kitchen
    # it is desired to keep Bedroom cool, so it's commented out for now
    #- service: climate.turn_on
    #  entity_id: climate.bedroom

announce_everywhere:
  sequence:
  - service: script.sonos_say
    data_template:
      sonos_entity: group.all_sonos
      volume: 0.3
      message: '{{message}}'

sonos_say:
  alias: "Sonos TTS script"
  sequence:
    - service: sonos.snapshot
      data_template:
        entity_id: "{{ sonos_entity|default('group.all_sonos') }}"
    - service: sonos.unjoin
      data_template:
        entity_id: "{{ sonos_entity|default('group.all_sonos') }}"
    - service: media_player.volume_set
      data_template:
        entity_id: "{{ sonos_entity|default('group.all_sonos') }}"
        volume_level: "{{ volume|default(0.5) }}"
    - service: tts.google_say
      data_template:
        entity_id: "{{ sonos_entity|default('group.all_sonos') }}"
        message: "{{ message }}"
    - delay: "{{ delay|default('00:00:01') }}"
    - wait_template: "{{ is_state(sonos_entity|default('group.all_sonos'), 'playing') }}"
      timeout: '00:00:03'
    - wait_template: "{{ not is_state(sonos_entity|default('group.all_sonos'), 'playing') }}"
      timeout: '00:01:00'        
    - service: sonos.restore
      data_template:
        entity_id: "{{ sonos_entity|default('group.all_sonos') }}"

# Bathroom lights defaults

set_bathroom_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.bathroom_lights
    data:
      brightness_pct: 100
      kelvin: 9000
  - service: light.turn_on
    entity_id: light.bathroom_strip
    data:
      brightness: 255
      #hs_color: [180,71.429]
      rgb_color: [72,255,255]
      #xy_color: [0.167,0.341]


# Toilet lights defaults

set_toilet_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.toilet_lights
    data:
      brightness_pct: 100
      kelvin: 8000
  - service: script.turn_on
    entity_id: script.set_toilet_strip_to_default

set_toilet_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.toilet_strip
    data:
      brightness: 255
      #hs_color: [180,85.714]
      rgb_color: [36,255,255]
      #xy_color: [0.156,0.342]


# Hallway lights default

set_hallway_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.hallway_lights
    data:
      brightness_pct: 50
      kelvin: 8000
  - service: script.turn_on
    entity_id: script.set_hallway_strip_to_default

set_hallway_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.hallway_strip
    data:
      brightness: 199
      #hs_color: [270,28.571]
      rgb_color: [218,182,255]
      #xy_color: [0.307,0.245]


# Living room lights defaults

set_living_room_lights_to_default:
  sequence:
  - service: script.turn_on
    entity_id: script.set_living_room_relax_area_lights_to_default
  - service: script.turn_on
    entity_id: script.set_living_room_dining_area_lights_to_default

set_living_room_relax_area_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.living_room_relax_area_lights
    data:
      brightness_pct: 50
      kelvin: 9000 #6000

set_living_room_dining_area_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.living_room_dining_area_lights
    data:
      brightness_pct: 50
      kelvin: 9000 #6000


# Kitchen lights defaults

set_kitchen_lights_to_default:
  sequence:
  - service: script.turn_on
    entity_id: script.set_kitchen_countertop_lights_to_default
  - service: script.turn_on
    entity_id: script.set_kitchen_island_lights_to_default
#  - service: script.turn_on
#    entity_id: script.set_kitchen_cabinet_strip_to_default
  - service: script.turn_on
    entity_id: script.set_kitchen_island_strip_to_default

set_kitchen_countertop_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.kitchen_countertop_lights
    data:
      brightness_pct: 100
      kelvin: 5500

set_kitchen_island_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.kitchen_island_lights
    data:
      brightness_pct: 50
      kelvin: 6500

set_kitchen_cabinet_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.toilet_strip
    data:
      brightness: 168
      color_temp: 115

set_kitchen_island_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.toilet_strip
    data:
      brightness: 126
      color_temp: 111


# Office lights defaults

set_office_lights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.office_lights
    data:
      brightness_pct: 66
      kelvin: 9000


# Bedroom lights defaults
set_bedroom_downlights_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.bedroom_downlights
    data:
      brightness_pct: 50
      kelvin: 9000

set_bedroom_lights_to_default:
  sequence:
  - service: script.turn_on
    entity_id: script.set_bedroom_downlights_to_default
  - service: script.turn_on
    entity_id: script.set_bedroom_cabinet_strip_to_default
  - service: script.turn_on
    entity_id: script.set_bedroom_strip_to_default

set_bedroom_cabinet_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.bedroom_cabinet_strip
    data:
      brightness_pct: 50
      kelvin: 9000

set_bedroom_strip_to_default:
  sequence:
  - service: light.turn_on
    entity_id: light.bedroom_strip
    data:
      brightness_pct: 75
      kelvin: 9000

